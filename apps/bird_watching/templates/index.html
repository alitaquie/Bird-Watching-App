[[extend 'layout.html']]

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""/>

<style>
[v-cloak] {
     display: none;
}
#map { height: 100vh; }
</style>

<div class="section" id="app" v-cloak>
  <div class="columns">
    <div class="column is-two-thirds" id="map"></div>
    <div class="column">
      <h1 class="title"><i class="fa-solid fa-cube"></i> Bird Watching App</h1>
      <div class="buttons">
        <button class="button is-primary" @click="goToChecklist">Sumbit a checklist</button>
        <button class="button is-info" @click="goToSightings">My Birding</button>
        <button class="button is-warning" @click="statsOnRegion" v-bind:disabled="!rectangle">Statistics on region</button> 
        <button class="button is-danger" @click="clearPoints" v-bind:disabled="!rectangle">Clear Rectangle</button>
        <button class="button is-danger" @click="clearSpecies" v-bind:disabled="selectedSpecies.length == 0">Clear Species</button>
      </div>
      
      <div class="field">
        <label class="label">Select Species</label>
        <div class="control">
          <input
            class="input"
            type="text"
            placeholder="Search species"
            v-model="search"
            @input="filterSpecies"
          />
          <div class="box">
            <ul>
              <li
                v-for="species in selectedSpecies"
                :key="species.id"
                @click="deselectSpecies(species)"
                class="species-item is-primary button"
              >
                {{ species.name }}
              </li>
            </ul>
          </div>
          <div class="box">
            <ul>
              <li
                v-for="species in filteredSpecies"
                :key="species.id"
                @click="selectSpecies(species)"
                class="species-item is-active button"
              >
                {{ species.name }}
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

[[block page_scripts]]
<!-- Loads the index-specific js for Vue -->
<script>
  let my_callback_url = "[[=XML(my_callback_url)]]";
  let get_species_url = "[[=XML(get_species_url)]]";
  let get_sightings_url = "[[=XML(get_sightings_url)]]";
</script>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
crossorigin=""></script>
<script src="js/leaflet-heat.js"></script>
<script src="js/index.js"></script>
[[end]]
